<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />

	<link rel='icon' href='/whale.svg' color='#fff'>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@kion_dgl" />
	<meta name="twitter:creator" content="@kion_dgl" />

	<meta property="og:title" content="MML2 State Viewer" />
	<meta property="og:description"
		content="MML2SaveStateViewer is a tool for visualizing the state of memory in Megaman Legends 2 for the PlayStation(PSX)" />
	<meta property="og:url" content="https://mml2.dashgl.com/" />
	<meta property="og:image"
		content="https://user-images.githubusercontent.com/25621780/224491317-330eab52-6df5-4588-b006-5858f120564a.png" />

	<title>MML2 StateViewer</title>

	<link rel='stylesheet' type='text/css' href='/layout.css' />

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">

	<script type="importmap">
			{
    			"imports": {
      				"three": "https://unpkg.com/three@<version>/build/three.module.js"
    			}
			}
		</script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
		crossorigin="anonymous"></script>

	<script src="https://kit.fontawesome.com/da43231f0c.js" crossorigin="anonymous"></script>

	<script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>

</head>

<body class='p-0'>

	<script type="module" src="/src/Frambuffer.ts"></script>

	<!-- Start State Select -->

	<div class='appbar text-bg-dark p-2'>

		<h1>
			<i class="fa-solid fa-whale"></i> MML2 SaveState Viewer
		</h1>

		<hr />

		<select id='state-dropdown' class="form-select">
			<option>Currently no file</option>
		</select>

		<div class='drop-area' id='asset-list'>

			<div class='icon'>
				<i class="fa-solid fa-upload"></i>
			</div>

			<span>
				Drag and drop here or
				<u id='file-trigger'>select</u>
				a file
			</span>
			<input type='file' id='file-select' />
		</div>

		<hr />

		<section class='state-list'>
			<nav class="nav mb-2 nav-pills nav-fill justify-content-between">
				<a class="nav-link text-white active" href='#' aria-current="page">Entity</a>
				<a class="nav-link text-white disabled" style='opacity: 0.5'>Player</a>
				<a class="nav-link text-white disabled">Map</a>
			</nav>

			<ul class="list-group" id='asset-select'>
			</ul>
		</section>

		<hr />

		<section class='feedback'>

			<div class='profile'>
			</div>

			<h2>DashGL Project</h2>
			<h3>@kion_dgl</h3>

			<div class='bottom'>
				<a href='https://www.youtube.com/@kion_dgl' target='_blank'>
					<div class='circle yt'>
					</div>
				</a>

				<a href="https://twitter.com/intent/tweet?screen_name=kion_dgl&ref_src=twsrc%5Etfw"
					class="twitter-mention-button" data-show-count="false" target='_blank'>
					<div class='circle tw'>
					</div>
				</a>

				<a href='https://www.patreon.com/dashkion' target='_blank'>
					<div class='circle pt'>
					</div>
				</a>
			</div>

		</section>

	</div>

	<section id='state-list' class='state-list hide'>
		<ul id='state-select' class="list-group list-group-flush">
			<li class='list-group-item'>Stage 0x00 Area 0x00</li>
			<li class='list-group-item'>Stage 0x00 Area 0x00</li>
			<li class='list-group-item'>Stage 0x00 Area 0x00</li>
			<li class='list-group-item'>Stage 0x00 Area 0x00</li>
			<li class='list-group-item'>Stage 0x00 Area 0x00</li>
			<li class='list-group-item'>Stage 0x00 Area 0x00</li>
			<li class='list-group-item'>Stage 0x00 Area 0x00</li>
			<li class='list-group-item'>Stage 0x00 Area 0x00</li>
		</ul>
	</section>

	<div class='version'>
		v0.1
	</div>

	<script type="module" src="/src/StateSelect.ts"></script>
	<script type="module" src="/src/AssetSelect.ts"></script>

	<!-- End State Select -->

	<!--  Start Main -->

	<div class='top-nav'>
		<li id='toggle-btn'></li>
		<li id='download'></li>
		<a href='https://github.com/DashGL/Tool-MML2SaveStateViewer' target='_blank'>
			<li id="github"></li>
		</a>
	</div>

	<div class='right-nav'>

		<li id='tool-screenshot' data-text='Take Screenshot'>
		</li>
		<li id='tool-skeleton' data-text='Show/Hide Skeleton'>
		</li>
		<li id='tool-grid' data-text='Show/Hide Grid'>
		</li>
		<li id='tool-reset' data-text='Reset Camera'>
		</li>

	</div>

	<div class='anim-controls hide' id='anim.controls'>
		<select id='anim.select'>
			<option>No Animation</option>
		</select>
		<button id='anim.play'>Play</button>
		<button id='anim.pause'>Pause</button>
		<button id='anim.stop'>Stop</button>
		<button id='anim.next'>Next</button>
		<button id='anim.prev'>Prev</button>
		<input id='anim.frame' type='range'/>
	</div>

	<canvas id='canvas'></canvas>
	<script type="module" src="/src/main.ts"></script>

	<!-- End Main -->

	<!-- Scripts -->

	<script type="module">

		import { GLTFExporter } from 'three/addons/exporters/GLTFExporter.js';

		document.getElementById('download').addEventListener('click', () => {
			if (!window.mesh) {
				return;
			}

			const exporter = new GLTFExporter();

			// Parse the input and generate the glTF output
			exporter.parse(
				window.mesh,
				function (gltf) {
					downloadObjectAsJson(gltf, window.mesh.name)
				},
				function (error) {
					throw err;
				}
			);
		})

		function downloadObjectAsJson(exportObj, exportName) {
			const str = JSON.stringify(exportObj, null, 2)
			const uri = encodeURIComponent(str);
			const dataStr = `data:text/json;charset=utf-8,${uri}`
			const a = document.createElement('a');
			a.setAttribute("href", dataStr);
			a.setAttribute("download", `${exportName}.json`);
			document.body.appendChild(a);
			a.click();
			a.remove();
		}

	</script>

</body>

</html>